<div class="post-list">

  <div class="card">
    <form class="post-form" id="new-post-form" action="/posts" method="post">
      <input
        id="message-input"
        class="message-input"
        name="message"
        type="text"
        placeholder="Hi {{user.firstName}}, what's on your mind?"
      />
      <input
        id="img-input"
        class="message-input"
        name="image"
        type="text"
        placeholder="Insert URL"
      />
      <input type="submit" value="Post" />
    </form>
  </div>

  {{#each posts}}

    <div class="post-container card" id="{{this._id}}">
      <div class="actual-post">
        <div class="profile-picture">
          <img
            src={{this.user.profilePicture}}
            width="100"
            height="100"
            class="rounded-circle"
          />
        </div>
        <div class="post-body">
          <div class="post-header">
            <span class="post-author">{{this.user.firstName}}
              {{this.user.lastName}}</span>
            <div class="date-posted">{{this.datePosted}}</div>
          </div>

          <div class="post-content">
            {{#if this.image}}
              <p class="image">
                <img src={{this.image}} width="200" height="200" />
              </p>
            {{/if}}

            <p class="message">
              {{this.message}}
            </p>

          </div>

          <div class="post-footer">

            <p>{{this.comments.length}} comments</p>
            {{!-- <p>{{this.likes.length}} likes</p> --}}
            {{! buttons for likes, comments, update post will be here }}
            <div class="likes">
              <p>{{this.likes.length}} likes</p>
              {{! use handlebars conditional to show the like button when the post hasn't been liked }}
              {{!-- {{#ifIn ../loggedInUserId this.likes.user}} --}}
              <p>{{this.likes}} users go here</p>
              <form class="unlike-form" action="/likes/remove" method="delete">
                <input type="hidden" name="postId" value="{{this._id}}" />
                <input type="submit" value="Unlike" />
              </form>
              <p>{{../loggedInUserId}} logged in user goes here</p>
              {{!-- {{else}} --}}
              <form class="like-form" action="/likes/new" method="post">
                <input type="hidden" name="postId" value="{{this._id}}" />
                <input type="submit" value="Like" />
              </form>
              {{!-- {{/ifIn}} --}}
            </div>
          </div>
        </div>
      </div>
      <div class="comments-list">
        <form class="comment-form" action="/comments/new" method="post">
          <input type="hidden" name="postId" value="{{this._id}}" />
          <input class="comment-input" name="comment" type="text" />
          <input type="submit" value="Add Comment" />
        </form>
        {{#each this.comments}}
          {{! Loop through all available comments linked to the above post id }}
          {{! Each comment will have its own div -> user profile picture, name and message +/- time }}
          <div class="comment-container">
            <div class="comment-profile-picture">
              <img
                src={{this.user.profilePicture}}
                width="30"
                height="30"
                class="rounded-circle"
              />
            </div>
            <div class="comment-body">
              <div class="comment-header">
                <span class="comment-author">{{this.user.firstName}}</span>
                <span class="date-posted">{{this.createdAt}}</span>
                {{! comment's user name and time posted }}
              </div>
              <div class="comment-text">
                {{this.message}}
              </div>
              <div class="comment-footer">
                <div class="likes">
                  {{! I want to display the number of likes a comment has here }}
                  {{! Each post has an array of comments, trying to work out how to iterate through them }}
                  <p>{{this.likes.length}} likes</p>
                  <form
                    class="comment-like-form"
                    action="/comment-likes/new"
                    method="post"
                  >
                    <input
                      type="hidden"
                      name="commentId"
                      value="{{this._id}}"
                    />
                    <input type="submit" value="Like" />
                  </form>
                </div>
              </div>
            </div>
          </div>
        {{/each}}
      </div>
    </div>
  {{/each}}

</div>